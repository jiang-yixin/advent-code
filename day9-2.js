// test
// const input = ['2199943210', '3987894921', '9856789892', '8767896789', '9899965678'];

// firefox
// const input = ['2127897678998676894313987643134789876543434987678932345965421298989998743210145989653456789543212456', '1056789569876545679524598854545689765432123996567891959895310197678998654359239879542345699765401347', '2245893458989434788965699967876789897643439875469999797689923998587899765498998765431234569543212398', '9499912967898323567976989878987895999654545997348998654567899876456789876997439876510123478954394989', '8978909898987456978989876989998954989897656797657897543489910975345699989875421987321235589765989978', '7567899789876567899998965399969893976998767998798976701567999863245988998996410198934356678978978767', '4348998678988998967897894219856789984589989999899654323488987652129876987989321239765477889989869945', '5457897567899659456986789998745696943467896899998765454599986543098765435678932349876567993497657834', '6667895456789542399765498899534785892356795789019876565679397653129876566789649498987899212987545125', '7778943345895421989873347678921234789467893578923989879799298854234987879898798987898934929976321016', '9899321256789592976432134569432345678989922459894596989998989976349999989999987546769899898765432135', '2999432347899989876541015678943457989993210998789954599987676897498987696789998423856789769898543234', '1397954459999875987763237789655698999875399766567895798976545789987996515569879212345678954987654659', '2986896598999964399854346898767789432976987654356789997995434997676789403498765423476899123599965767', '9995789987989543298765657899898994321099798765467898886789759887545693212979998534589921034598796878', '8854699876578954369987867998979498752197679876878997675789898765434579439865987657678932126798689999', '7653986543457965456998978997654349543986565987989876554679959876312389998654598768799874235987578924', '8762399874668996789899989898763298765799434598999877323488949943101249876543329899998765399795456899', '9821298765978989899789498799821019879998945689798765434567998654323347997721012987989876987654345678', '5432349876789667987689234679932923998767976797669876545679239967457656985432323495479989998973234599', '7653656987896549876510134569899894987656988989545998766789999896569869876554536589356999869765345678', '8995767998997432989432249789789789998967899879439899987999888789689978989865787679277897659887897799', '9989898999987643987543698997675678919878988768998789998997675689893989998976788792125789545998998989', '7878999997898954599654567898544578909989677657896579999986524599932199867987899891014898956799449678', '6567899876789867698767898987623567898796543546976467899875312679549989756798910954323457897892323579', '5456789865798988789878919876544899944598652125894356799964303578998775635669892985454768998921012357', '6578998974567899894989323989875678932987654034689167899875213467899654423456789876579899659434223456', '7989987896698999923899569997987899321298543125679878901987824569999763214878996987897999549645394567', '8999876797899889212688998976498976490129654346789989899999434598899874323989324998956798998656989678', '9459865989987678923567977897319987989998776658991296798898945976789985434789909869867987899868978999', '1297654578976567894599756999423498976899989769210145987757899864567897565699897654989876978979867899', '2984553568997458965987649899564999985689790989921236986546789653678998987789789943299865867899756989', '9873212779998569876799534768979899976797652499892959877435678954789769198993567894989764556798979878', '9762102389987679987998423459998789989898743988789898764323489769899854399212456789876553545787898765', '8743212387898789199987515767997657892997659975698789875212599878998765988924567898765432134456789954', '7656326456899893245697623499987545943698998754894678987101278989999899876799779999874321012367899893', '8766546567899994357986434989897657954569879643253459998234567899878999865678999998765432133456789762', '9898757878948789469897899878798998968698765432101268999455678998767998764569898919987543245777899843', '9999868999234679598798989765689209979999876954216999498677989893456789343698787934598654356889967955', '8799978920134797699679976774978999989887989875425889599789598754678993201799656895679975677992459896', '7678989321295989989569865443769989998765492995434678989893489866899994319987545789899896789991298789', '8589995439989878976498778332356678999974321297567889476942678977945986998999334499999797998989397679', '5468997698875767895359643201234589987543210198679991345894567988932199876789212357895679876578976568', '6679659797664656789298756312345678998659421239989982496789978999993249765678923789964598765467895457', '7892345986542547994359895423456989999798934346799976587899899999989497534679895689012349865376799345', '8901239875430239965467997934767899897987945456789987698998799987878989423567789792123497654245678956', '9212498765321349896778987545889987786456899569898899789987689986656679212345678989434569775678989767', '4323989876732399789899987676790296654365678998987789891296569875434598993457999878945979996799799878', '6539876986543987678976599789891985733234567897665678990987679986321456789569875467959899987896541989', '7898775499859876547895459893999864210123789986424569989998894987432358897698764347898789999965430196', '8999664369767998756789349901299754321245699875313457979869923976544789989799875456789578998965321245', '9998543249878999767893298919989865452376789654201378965456894987685678979899989767895456467999432467', '6987654567999999988999987998979878763589895975613456954346799898776789569978999898954314345678954578', '5498975698999989999998976656867989874678934986894579893236789759887992398867899999654301236899965689', '2349298789898678901987545343455699989789423987965698789345678945998931987656567898764212345679876796', '1492109898796546699876532101234789999897912398876988678957899234569540198744457999865324567899989895', '0989912999689134589987543212345678978986899469989976567898910123578951987632379899976545989989993934', '9879899998578995679987698654896789569875678989998965458999321239699892398540256789988657997678932123', '8765698766456789790198789765787893398764567899987654347698954398998789987641234997699898964567893254', '9854597654345999891999999876898921296543235798999864234567895987586679998932656896569979753477894347', '8966987643234899999892102987999510989792199987789542123458999878494567899843767943457965432356989456', '7698998732123799999789212998984329878989987545678931015867987654343498998654588932369874321245678977', '4569998754345678987678929899965498768779876534458942123989999843212989329776689643456985210124899098', '3499789965456789976587898767896599654567989214347895435679899954101978910987899865677894342246789199', '4987679876667998765456789656789987663412498501256896546798788943229869891298910987788999943358998989', '9876578987979899754345692345678996532101987432345789657987676794398756789989439698999998896479877578', '9865456899898789656236794556789987643419876567899898768976545895999545678968998549545997689589765458', '7654345798765678942134895877890198984523987678998969878998436789895434799657897667939876579998642367', '9743234679854567893245986798931299876634698789987656989876545998754323899546799788998655468895431345', '8754123498765678965757897989949989987745789898798767999998689899895435678935688999896544356799430123', '9873236789976989879998999878898679998876996955679879898549896689986547899923567899765433245678921234', '4986545697698995990139998767689568999987894544578998767533934568998658997894578979854321014789932356', '3497956989559024921239876553569459998998943423599569654321023456789769876789678967965762123599893467', '2989899879432129892356997432488968996999862013489459785632436567899978965456999656987653234789794578', '9875768968993298789997989551567899989899973124578979876545557678999989654345878943299754356997679989', '9764454557989987696789876532898939879789989235689989997786878789788996543234567892129898456789567891', '7653212345978999545678987656789549765678998945792398798897989897657987632123457893239876567892456910', '6542103459956789223899998868899998654569467967899989549998995938545899821034578954345987678901688922', '7654713998745679019998999979999869732479338998998978932389654320134789752156689766787898799213899993', '8765629897634467998787889989198754321569123789987569893479765434545689843278793997898949894345789789', '9886798654524346789656678993239865587678935689876458799568986755678999654689891989969435965986896698', '1998987543210289899544569654345976799789545679854347678979987999799298767896989878954319876898954597', '2989698954322779998623678967478989899899956898743234569989199878989129979975678969543201987989543986', '9876559766433568999654567899567997974969898987642145689994299769878949989654989656994312998979691975', '9965449898965878998795678978979876463456789999853234567896987654567898797643895448789429899768989987', '8654323999878989319989989869899964321567899989964345678999998943478997699432689235668998798657878999', '9798414598989698909978998756789876432878978879875899789898999854679876578993590123456789698743467890', '9997523997694567898767899845699987643589665367996789898766898765698764356789689234577896549832579932', '9899639889543458999658999434989998789696554245697893999954779977789893298999894395989965439943567893', '8798998765612345987649898912978999898789432134598954989763567898899954989456976989999876598997678964', '7697989954201234598732767999868899929897993249679999868322345909999899878967989878901989967989789875', '6545679876345348999821656789756789101956789398999987543210458912398795967978999767892399857679991989', '5434589987466467987510345897647998932345999987989998667321567893987654356799329878993998643567890995', '7623491299567679875431256998734567894569878436767999779542678949876543267899410989679875432375789876', '3212989998978989985432345987523458987698765425458989987654789530998764588998921393598964321234578997', '4329879876899799876543467895434679398789896202345678999767897921239965799987899932987543210123456789', '5498765345789654987656798976546793239999954314569789129898956892456986789676598893987654324545567895', '6987653235678943298787899987897892127689965435678995398989347793678997896563456789598766436656698934', '8998732123459942109898946498989921013579876566799876987673234689999498965452346995469887645787789312', '9439851012567893235999532349765432123489989679899987899432124567892359764321245789312998789899896434'];

// chrome
const input = ['9874321292198975458901239986401245679543234590129878943236789999863345679876578901978456778910976423', '9965434789987854346893498793212357898753125789998767954345789987651266799765457899854234567899997910', '9876545695986543234989987654323569999654247999898757895456793499540656989755348999765195678978999891', '5988856894597654345678999876435678998765348998789546796569894568932349876543257998976989989569998789', '6799768943498785656789456987545989579876456789689235689878965679899499986432167577989878993468987678', '7999879894679896777892349987656993467987598996563124598989876799767989997621012356798767892389898465', '9899998796789987888921298798867894678998789876432012457899987987655678998543143456789659910198764343', '5789997689891298999210987689988965789469898765432123678989999876543568987654554567998799791999953212', '4579886578910989434991396578999879894398979876543267989567789998712456999875665678929898679899999923', '6797675487899876526889987467899989999987654998665348995434678939901267899988776899019976535678987899', '8965452346789865435679876578999894698996543239765467894324579129894345678999988992198765324579876798', '9894321257894976576789987889698743987989992123986567975434598999789966989129999789349896545698654567', '6789432345995987987999999996569654596577889965987678996945997876567897891098945689467987657976543456', '5678943489989998998999898995459875987465679896799789879899876743456789932987334999978998798989942465', '4599976568978989999998767889310989876323568789989898965789985432579899949996229879899869939399861254', '7678997679767869899987656778921299975212345679765977896895796431298989898765109768789654321298750123', '8799398989756556799786545568942349954326656789763256789954989910987676789843297655678969572359842354', '9892129996545445988654335459959498765545767899854345898769878899886545998764987643789998765498756878', '3932099987632339876543212367898999876787878998765656789899765798765434899979843212456999879699867889', '2393989998741024987543101234567899987899989659878767893987654597654323789998732104767898998789978998', '1989878999843266898754215345788969998930296545989979992098543129973212679876543212378987679992989456', '9876767998764356999865326456799457999321989432599898789198762098765323567999698345679996565894599568', '8765659899875667899987547567892398998949878921398779564989654599896464778998796456789876434789798999', '8954345799986878989798658789943456987894567892987654453578966789987975689999987967894989545678987989', '7543234689498989877659879999654667976789779999876543212346987894398986799989598978943498956989876567', '5432129795239998767545990198765678985678989998987662103567899999459997898765439989912987967898965475', '6554578894346899843235689239876789876789697897998743215678912398967998999875323499899986898987893234', '7685678965456987656123579345987899998993466976899764376789904987899899789996784789798765989656999645', '9796789876767999764334989956798999659201245998939878988897899896789653678987895679679989878537898997', '9898998989878998765445996898989998995313359899910989999976798765678932489899998789543298767423957989', '3959987693989989876567895789978987989924599789892997896545987654687893599767999896532129854212345678', '2348799432397879997678964598767576567895978656789765987659976743556789678956799974321045965102389789', '0147698921236568998989532349754321389999767545699986798798765432345678989347899865432129873216578995', '1234597990123459219297543498765410499997656434987897899979987631496789690157899976559998765323679343', '2349986789245569109109694589879531459876542123456789999762198542387899532378989987698759865445789212', '3498965678976678998999887678998952378997683012567890198951019653498978943489678998797643986776789101', '4987654549797789456789998789987967456789794324778932987943434966579769894596559879898759997887893212', '5698643235679896567899989899876798767898765446989993986799659899789656789689349765929898999998985543', '6987654456998997678999978989765989898959898767897989985678969768997647898789234954310987894319976754', '7898765769897898899998765678954578989431939878956879874789498756795438999892129865499876789423987976', '8999879898756789910987654567893465678910123989543768953499319897976656796931012976987654597975699987', '9998989987645699991296423458921234567891234599532359767988998969988768895432323987899543456797893499', '9997698765436987889999101568953345798932359698763579899876797655399879996654435699998932345689932349', '9876579876545696877898242679854656799985498987654578999754986543212989989766545998767891234579321098', '9775454987679985656987656898765767899876997899786799999643497654523599978987699897658799545678932987', '8654323498798974345798987999976898954989876899999899878932198976654569867899989654347678968799899876', '6543212349987661256999098998989999743299987988899989768921019899767698754568979792124567899896799765', '7684102478999543569892129897991987654368999876789878959432398798998979843979757989235678998975678976', '8878523567987654799789246796510199875456798765198766698943497656789567959897646879345789597643467897', '9865439798998786987678957895423469976788899854097954577894989899993469869765434567976898489932345699', '6976598989459897976568978976534567897899998762196543456789878978932346979887123578987897567896556789', '5987987978969989875459899987676699989998999973987654567899955767891237898765012356899998989997678998', '4699876567898776984345789998787988878987998765698765678998643456899998999654323589999989794649789026', '3498765456799665695656898999899867569876649976799876789987654667978789998765537678989976543239893245', '2239875349896543469868976989998754398764534989890987997699768778965678999877645789667899694398999656', '1099874235789662356989765678987654239973223498921298986543979899354567895988789897545798989987698787', '2987663124578954967999854579998766345985104567892349897932989943213678934599996936435987879543459898', '3976543023679869899898743498989897459876715779954556789893497654101289025698654321029976768932346999', '9865432146789998789797654987678989968987896898767967896789589864262568934989896543198765457891097989', '9876563237899987698689765976565679899998997999979878985679678987653478949876987654239985376789989674', '5988678945999876576578996985434598778999698987989989764568989698754567899545799865349873265679976543', '4399989856789986432456789543129987669899899996592099543456996549765678978426578976598762123457897632', '3297798767899987964589899653298976545799998789439978432349897639876989764212376987679854348967898544', '9975689899978998875678978969987895434598998677998764321298789321987899543101345698889975457898999656', '8764789934569899876789467998976789321987797566899954210965678939998998654213456899999876567899789767', '9643489946698797997892348987675699490196542365789854399899789998999897654338767998754988678925678979', '8776567897997676798951257896544568989984321234698769988678991987898798965445698999543298789434567899', '9887879999876545679432345986432345678976542345799998776589890976765679896676789989694349897547698998', '6998999989987858989543456796543456789987653456967897655458789865454598779788895878989459987698789476', '4239998975498767897654568987994579896498764878943498432345678986323989568999934567979598998789892345', '5345987654329878969795979099876689965349876989432987651234789875459876479989423989867987989899954756', '5467898743210989978976789123997791094234997896521098862345699986599765345678964698754346678999865677', '6568929854332397899987898236789892989375698997432129877657789997989876234599879989543234598987987789', '7679019965465456794598997545899919879986999989643334998779996899878987945789998767434123457896598892', '8989998987698767893459989656898939767899898879965455799892025698767998986898987654321012356789439993', '9797897698799988976569878967897898656789767767896566893943934599748799998967899976542153467899546789', '5556986439999799897898769898956984345697656856789677892969895987635689869456789987654767578998958893', '4349987746997689789997657799439876767987643447899789999898789997546789954347894398786777679997899932', '4298987659876545678976546689323998998988532138967992398765678999869899875956901239898898789876689321', '9987598767989756789683634578939889319875421012347890239854789998978954989898913398999989897664598910', '8976459889899867897542123456998778929876732123456789398753678987989763098789994987999878976543767891', '7984341996789978965432012359894567999998543234687893987654567896799862198697889996789767989432349943', '6543210345678989997543143598763456789497654356798901999865678965679654297576678945678959876543998964', '8765431256789899987656264598654567892398767467899219865976789954778976986464569123799643988999897895', '9996932345698798999894347698765678901299978578989397654989899853567897985323678934895432499987656989', '9889893476789577899975498979878789312987989989679986543296998762456789875412357895996591991298545678', '9765789687895456789989569656989897993976593096578997410145699851267899965101345976789989789987656789', '9896999798954345878999678948997976889998432123479994321234987540348999754212468897997875679898787898', '9987979899999234569898789139986565678987643234567989932355699631259398767323456789966764598769898957', '8998967999887956779789894398765454568998754645679878895456798743459219975456567898755323987654929346', '7899543597676799898657999999654323456799876896998768789578899854598934989567778999544212598732101245', '6789432976545678987545298898743212347913987939876456699789967967987895698779899989432103496543212356', '5678943987435899998932187799993201237895698924954334578994359879896789789989999978999312987695323467', '3567899876596910976543345698789513456987789939890123689965212996785678996490198969988924598987834678', '2778943989989921297655456898689434589998999899789235789754329985634579987321987858877895989898945689', '3469642498979892398986987996578995678919988689699946899866598764323789996469976646566789977659867792', '6578931987656789989497899975434989789109876534587897896977899876545678987998765431345699867345978893', '7989649896648799875398989764325678997219765423466798954989965998656789599869896542476789643236989954', '8999798765536689953239579875537889765329899312345899653297543569767894469953987656789898754547897995', '9212987654324567892123457986756999976434987501234999867898321349898902398654599877899999865679976789'];

let _inputs = [];
for (let i = 0; i < input.length; i ++) {
    const line = input[i].split('').map((cur) => parseInt(cur, 10));
    _inputs.push(line);
}

let lowPoints = [];

const height = _inputs.length;
const width = _inputs[0].length;

const validPosition = (j, i) => (0 <= j && j < width) && (0 <= i && i < height);

// axe : x <=> j, axe y <=> i

let basinMarkers = [];

for (let i = 0; i < height; i ++) {
    let line = [];
    for (let j = 0; j < width; j ++) {
        line.push(0);
    }

    basinMarkers.push(line);
}

const directions = [
    [0, -1], // up
    [0, 1], // down
    [-1, 0], // left
    [1, 0], // right
];

const findBasin = (i, j) => {
    // console.log('findBasin', i, j);

    if (!validPosition(j, i) || _inputs[i][j] === 9 || basinMarkers[i][j] === 1) {
        return 0;
    }

    basinMarkers[i][j] = 1;

    let area = 1;

    for (let k = 0; k < directions.length; k ++) {
        const [xAction, yAction] = directions[k];
        const xPos = j + xAction;
        const yPos = i + yAction;

        area += findBasin(yPos, xPos);
    }

    return area;
}

const getAdjacents = (i, j) => {
    let validAdjacents = [_inputs[i][j]];

    const leftX = j - 1;
    const leftY = i;
    if (validPosition(leftX, leftY)) {
        validAdjacents.push(_inputs[leftY][leftX]);
    }

    const rightX = j + 1;
    const rightY = i;
    if (validPosition(rightX, rightY)) {
        validAdjacents.push(_inputs[rightY][rightX]);
    }

    const upX = j;
    const upY = i - 1;
    if (validPosition(upX, upY)) {
        validAdjacents.push(_inputs[upY][upX]);
    }

    const downX = j;
    const downY = i + 1;
    if (validPosition(downX, downY)) {
        validAdjacents.push(_inputs[downY][downX]);
    }

    return validAdjacents;
}

const basinLists = [];

for (let i = 0; i < height; i ++) {
    for (let j = 0; j < width; j ++) {
        const currentValue = _inputs[i][j];

        const validAdjacents = getAdjacents(i, j);

        if (currentValue === Math.min(...validAdjacents) && currentValue !== Math.max(...validAdjacents)) {
            // console.log('---new low point---');
            // console.log(' ');
            lowPoints.push(currentValue);

            // call the function to get basin
            const basinSize = findBasin(i, j);
            // console.log('basinMarkers');
            // console.log(basinMarkers);

            // console.log('basinSize', basinSize);

            basinLists.push(basinSize);
        }
    }
}

// console.log(lowPoints.reduce((acc, cur) => (acc + cur + 1), 0));
// console.log(lowPoints);

basinLists.sort(function(a, b) {
  return a > b ? -1 : a < b ? 1 : 0;
});

console.log(basinLists[0] * basinLists[1] * basinLists[2]);

